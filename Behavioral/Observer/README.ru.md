# Шаблон Наблюдатель (Observer)

## Тип: Поведенческий

## Назначение
Определяет зависимость типа "один ко многим" между объектами таким образом, что при изменении состояния одного объекта все зависящие от него объекты оповещаются и обновляются автоматически.

## Проблема
Когда состояние объекта изменяется, все зависимые объекты должны быть уведомлены и обновлены соответствующим образом, но без тесной связи между классами субъекта и наблюдателя.

## Решение
Выделение функциональности наблюдения в отдельный интерфейс наблюдателя, что позволяет нескольким независимым наблюдателям получать уведомления об изменениях состояния.

## Когда использовать
- Когда изменение в одном объекте требует изменения в других, и вы не знаете, сколько объектов нужно изменить
- Когда объект должен уведомлять другие объекты, не делая предположений о том, кто эти объекты
- Когда фреймворк должен быть расширяемым во время выполнения с наблюдателями, которые могут быть присоединены и отсоединены динамически

## Структура
![Наблюдатель](https://github.com/legrch/php-design-patterns/blob/master/~images/ru/Observer.png)

## Участники
- **Субъект (Observable)**: Знает своих наблюдателей и предоставляет интерфейс для присоединения и отсоединения наблюдателей.
- **Наблюдатель (Observer)**: Определяет интерфейс обновления для объектов, которые должны быть уведомлены об изменениях.
- **КонкретныйСубъект (ConcreteSubject)**: Хранит состояние, интересующее объекты КонкретныйНаблюдатель, и отправляет уведомление при изменении своего состояния.
- **КонкретныйНаблюдатель (ConcreteObserver)**: Поддерживает ссылку на объект КонкретныйСубъект и реализует интерфейс обновления Наблюдателя.

## Пример

```php
$station = new WeatherStationObservable();
$station->setTemperature(15);
$this->assertEquals(15, $station->getTemperature());

$customer1 = new WeatherCustomerObserver();
$customer2 = new WeatherCustomerObserver();

$station->attach($customer1);
$station->attach($customer2);

$this->assertEquals(null, $customer1->getTemperature());
$this->assertEquals(null, $customer2->getTemperature());

$station->setTemperature(26);
$station->notify();

$this->assertEquals(26, $station->getTemperature());
$this->assertEquals(26, $customer1->getTemperature());
$this->assertEquals(26, $customer2->getTemperature());

$station->setTemperature(10);
$station->notify();

$this->assertEquals(10, $station->getTemperature());
$this->assertEquals(10, $customer1->getTemperature());
$this->assertEquals(10, $customer2->getTemperature());
```

## Примеры из реального мира
- Системы управления событиями
- Механизмы подписки в системах обмена сообщениями
- Системы вещания
- Архитектура MVC для обновления представлений

## Связанные шаблоны
- **Посредник (Mediator)**: Инкапсулируя сложную семантику обновления, шаблон Наблюдатель можно рассматривать как упрощенный шаблон Посредник.
- **Одиночка (Singleton)**: Субъект (Observable) часто реализуется как Одиночка. 